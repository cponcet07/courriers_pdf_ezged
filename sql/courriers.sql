-- phpMyAdmin SQL Dump
-- version 4.8.5
-- https://www.phpmyadmin.net/
--
-- Hôte : localhost
-- Généré le :  mar. 23 mai 2023 à 17:59
-- Version du serveur :  10.4.6-MariaDB
-- Version de PHP :  7.3.4

SET SQL_MODE = "NO_AUTO_VALUE_ON_ZERO";
SET AUTOCOMMIT = 0;
START TRANSACTION;
SET time_zone = "+00:00";


/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8mb4 */;

--
-- Base de données :  `nchp_ezged`
--

-- --------------------------------------------------------

--
-- Structure de la table `courriers`
--

CREATE TABLE `courriers` (
  `COURRIERS_ID` bigint(20) NOT NULL,
  `COURRIERS_NUM_MODEL` bigint(20) NOT NULL DEFAULT 0,
  `COURRIERS_DATE` datetime NOT NULL DEFAULT '0000-00-00 00:00:00',
  `COURRIERS_FULLTEXT` longtext DEFAULT '',
  `COURRIERS_FIN` tinyint(4) NOT NULL DEFAULT 0,
  `COURRIERS_EZGEDVIEWED` longtext DEFAULT '',
  `COURRIERS_LIB` varchar(50) DEFAULT '',
  `COURRIERS_CLASSEURS` varchar(50) DEFAULT '',
  `COURRIERS_EZGEDUPDATED` longtext DEFAULT '',
  `COURRIERS_OBJET` varchar(255) DEFAULT '',
  `COURRIERS_CHRONOFROMID` bigint(20) NOT NULL DEFAULT 0,
  `COURRIERS_COPIE_A` varchar(255) NOT NULL DEFAULT '',
  `COURRIERS_ANNEE` bigint(20) NOT NULL DEFAULT 0,
  `COURRIERS_DESTINATAIRE` bigint(20) DEFAULT 0,
  `COURRIERS_CHRONOYEAR` bigint(20) NOT NULL DEFAULT 0,
  `COURRIERS_TYPE` varchar(50) NOT NULL DEFAULT 'D',
  `COURRIERS_ATTENTE` tinyint(4) NOT NULL DEFAULT 0,
  `COURRIERS_BUREAU_OK` tinyint(4) NOT NULL DEFAULT 0,
  `COURRIERS_TRAITEMENT_BUREAU` tinyint(4) DEFAULT 0,
  `COURRIERS_AFFAIRE` varchar(255) NOT NULL DEFAULT '',
  `COURRIERS_CHRONO` bigint(20) NOT NULL DEFAULT 0,
  `COURRIERS_DGS_OK` tinyint(4) NOT NULL DEFAULT 0,
  `COURRIERS_THEMATIQUE` bigint(20) NOT NULL DEFAULT 0,
  `COURRIERS_CORRESPONDANT` bigint(20) DEFAULT 0,
  `COURRIERS_EXPEDITEUR_SPECIF` varchar(255) DEFAULT '',
  `COURRIERS_DESTINATAIRE_SPECIF` varchar(255) DEFAULT '',
  `COURRIERS_SERVICES` varchar(20) DEFAULT '0',
  `COURRIERS_CORRESP_CAP` bigint(20) DEFAULT 0,
  `COURRIERS_TEL_SPECIF` varchar(255) DEFAULT '0',
  `COURRIERS_MAIL_SPECIF` varchar(255) DEFAULT ''
) ENGINE=InnoDB DEFAULT CHARSET=latin1 ROW_FORMAT=COMPACT;

--
-- Déclencheurs `courriers`
--
DELIMITER $$
CREATE TRIGGER `CHRONO INSERT` BEFORE INSERT ON `courriers` FOR EACH ROW SET new.COURRIERS_CHRONO=CONCAT( new.COURRIERS_CHRONOYEAR + ((YEAR(new.COURRIERS_DATE)-2000)*10000))
$$
DELIMITER ;
DELIMITER $$
CREATE TRIGGER `COURRIER_CHRONO` BEFORE UPDATE ON `courriers` FOR EACH ROW SET new.COURRIERS_CHRONO=CONCAT( new.COURRIERS_CHRONOYEAR + ((YEAR(new.COURRIERS_DATE)-2000)*10000))
$$
DELIMITER ;
DELIMITER $$
CREATE TRIGGER `DECOCHE CASE BUREAU A TRAITER` BEFORE UPDATE ON `courriers` FOR EACH ROW if new.COURRIERS_BUREAU_OK=1
THEN
set new.COURRIERS_TRAITEMENT_BUREAU=0;
END IF
$$
DELIMITER ;
DELIMITER $$
CREATE TRIGGER `UPPER AFFAIRE` BEFORE UPDATE ON `courriers` FOR EACH ROW set new.COURRIERS_AFFAIRE= UPPER(new.COURRIERS_AFFAIRE)
$$
DELIMITER ;
DELIMITER $$
CREATE TRIGGER `UPPER OBJET` BEFORE UPDATE ON `courriers` FOR EACH ROW set new.COURRIERS_OBJET = UPPER(new.COURRIERS_OBJET)
$$
DELIMITER ;
DELIMITER $$
CREATE TRIGGER `UPPER THEMATIQUE` BEFORE UPDATE ON `courriers` FOR EACH ROW set new.COURRIERS_THEMATIQUE= UPPER(new.COURRIERS_THEMATIQUE)
$$
DELIMITER ;

--
-- Index pour les tables déchargées
--

--
-- Index pour la table `courriers`
--
ALTER TABLE `courriers`
  ADD PRIMARY KEY (`COURRIERS_ID`),
  ADD UNIQUE KEY `KEY_F3051335095011121997` (`COURRIERS_CHRONOFROMID`),
  ADD KEY `VK_courriers_4QUHB6AR` (`COURRIERS_COPIE_A`),
  ADD KEY `VK_courriers_4QUHB6BK` (`COURRIERS_TRAITEMENT_BUREAU`),
  ADD KEY `VK_courriers_4QUHB6CD` (`COURRIERS_CHRONOYEAR`),
  ADD KEY `VK_courriers_4QUHB6CR` (`COURRIERS_TYPE`),
  ADD KEY `VK_courriers_4QUHB6DL` (`COURRIERS_CHRONO`),
  ADD KEY `VK_courriers_4QUHB6FN` (`COURRIERS_DESTINATAIRE`),
  ADD KEY `VK_courriers_4QUHB6GM` (`COURRIERS_OBJET`),
  ADD KEY `VK_courriers_4QUHB6H3` (`COURRIERS_ATTENTE`),
  ADD KEY `VK_courriers_4QUHB6HH` (`COURRIERS_CLASSEURS`),
  ADD KEY `VK_courriers_4QUHB6HT` (`COURRIERS_DGS_OK`),
  ADD KEY `VK_courriers_4QUHB6J4` (`COURRIERS_ANNEE`),
  ADD KEY `VK_courriers_4QUHB6JS` (`COURRIERS_FIN`),
  ADD KEY `VK_courriers_4QUHB6KB` (`COURRIERS_NUM_MODEL`),
  ADD KEY `VK_courriers_4QUHB6KU` (`COURRIERS_DATE`),
  ADD KEY `VK_courriers_4QUHB6N6` (`COURRIERS_AFFAIRE`),
  ADD KEY `VK_courriers_4QUHB6NM` (`COURRIERS_LIB`),
  ADD KEY `VK_courriers_4QUHB6OT` (`COURRIERS_BUREAU_OK`),
  ADD KEY `VK_courriers_4R9S9EJT` (`COURRIERS_THEMATIQUE`),
  ADD KEY `VK_courriers_4SD55122` (`COURRIERS_CORRESPONDANT`),
  ADD KEY `VK_courriers_4SDTMMD2` (`COURRIERS_EXPEDITEUR_SPECIF`),
  ADD KEY `VK_courriers_4SDTMME1` (`COURRIERS_DESTINATAIRE_SPECIF`),
  ADD KEY `VK_courriers_4SKS1AKK` (`COURRIERS_SERVICES`),
  ADD KEY `VK_courriers_4SLSTQCQ` (`COURRIERS_CORRESP_CAP`),
  ADD KEY `VK_courriers_4SMLGKN7` (`COURRIERS_TEL_SPECIF`),
  ADD KEY `VK_courriers_4SMLGKNT` (`COURRIERS_MAIL_SPECIF`);
ALTER TABLE `courriers` ADD FULLTEXT KEY `VK_courriers_4QUHB66B` (`COURRIERS_FULLTEXT`);
ALTER TABLE `courriers` ADD FULLTEXT KEY `VK_courriers_4QUHB6E2` (`COURRIERS_EZGEDVIEWED`);
ALTER TABLE `courriers` ADD FULLTEXT KEY `VK_courriers_4QUHB6LV` (`COURRIERS_EZGEDUPDATED`);

--
-- AUTO_INCREMENT pour les tables déchargées
--

--
-- AUTO_INCREMENT pour la table `courriers`
--
ALTER TABLE `courriers`
  MODIFY `COURRIERS_ID` bigint(20) NOT NULL AUTO_INCREMENT, AUTO_INCREMENT=209;
COMMIT;

/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
